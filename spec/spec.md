# パーソナルジム向け予約管理システム

## 1. ユーザー向けユースケース

### 1.1 ユーザー登録とログイン

- ユーザーはアカウントを作成し、ログインできる。
- 必須情報: 名前、メールアドレス、パスワード。
- ログイン後、以下が可能:
  - 自分の予約状況を確認。
  - お気に入りトレーナーを登録。

### 1.2 トレーナー一覧の閲覧

- ユーザーは店舗に所属するトレーナーの一覧を閲覧できる。
- 表示情報:
  - トレーナーの名前、経歴、専門分野。
  - 予約可能な時間帯。

### 1.3 予約の作成

- ユーザーは以下の情報を入力して予約を作成できる:
  - 日時（カレンダー選択形式）。
  - トレーナーの指定。
- システムは以下を確認:
  - 指定日時のトレーナーの空き状況。
  - 同時刻に予約が重複しないこと。
- 予約完了後、メール通知を送信。

### 1.4 予約のキャンセル

- ユーザーは予約をキャンセルできる:
  - キャンセルは予約の 24 時間前まで可能。
  - キャンセル履歴をシステムに記録。
  - キャンセル完了後、メール通知を送信。

### 1.5 予約履歴の確認

- ユーザーは自身の予約履歴を確認できる:
  - 予約日時、トレーナー名、セッション時間、予約状況（確定/キャンセル）を表示。

---

## 2. トレーナー向けユースケース

### 2.1 トレーナーログイン

- トレーナーは専用の管理画面からログインできる。

### 2.2 自身のスケジュール管理

- トレーナーは自身のスケジュールを登録・更新できる:
  - 予約可能な時間帯の設定・変更。
  - 予約済みの時間は変更不可。

### 2.3 予約状況の確認

- トレーナーは自身の予約スケジュールを確認できる。
  - 予約された日時、ユーザー名、セッション時間を一覧表示。
  - 予約状況（確定/キャンセル）を確認。

### 2.4 予約のキャンセル（トレーナー）

- トレーナーは自身の都合で予約をキャンセルできる。
  - キャンセルは予約の 24 時間前まで可能。
  - キャンセル履歴をシステムに記録。
  - ユーザーにメール通知を送信。

### 2.5 トレーナーの追加

- 権限を持つトレーナー（最初のトレーナーまたは管理者）が、新しいトレーナーを追加できる。
- 招待されたトレーナーは、初回ログイン時にパスワードを設定する。

---

## 3. システム全体のユースケース

### 3.1 認証と認可

- ユーザーとトレーナーの権限を分離:
  - ユーザーは予約関連機能のみ利用可能。
  - トレーナーはスケジュール管理機能を利用可能。

### 3.2 スケジュールの競合防止

- システムは以下を制御:
  - 同じトレーナーに同時刻で複数の予約が入らないようにする。
  - トレーナーの予約可能枠を超えない。

### 3.3 通知機能（メール）

- 予約完了時のみメールを送信。
- 予約キャンセル時（ユーザー・トレーナー双方）にメールを送信。

---

## 4. 非機能要件

### 4.1 パフォーマンス要件

- 予約処理のレスポンスを短縮。

### 4.2 セキュリティ要件

- 基本的な認証・認可を実装（JWT 認証など）。

---

## 5. 用語集

| 用語         | 用語（英訳）   | 定義                                           |
| ------------ | -------------- | ---------------------------------------------- |
| ユーザー     | User           | 予約を行う一般の利用者                         |
| トレーナー   | Trainer        | 予約を受け付ける指導者                         |
| 予約         | Reservation    | ユーザーがトレーナーのセッションを予約する行為 |
| スケジュール | Schedule       | トレーナーが管理する予約可能時間の一覧         |
| 認証         | Authentication | ユーザーやトレーナーの本人確認プロセス         |
| 認可         | Authorization  | 権限に応じた機能の利用可否を管理するプロセス   |
| 通知         | Notification   | 予約に関するメールなどの通知機能               |

---

## 6. 区切られた文脈

- アカウント・アクセス管理 (一般)
  - ユーザーアカウント
  - トレーナーアカウント
  - パスワード認証
- プロフィール管理 (補助)
  - トレーナーのプロフィール
- 予約・スケジュール管理 (中核)
  - 予約
  - トレーナーのスケジュール

---

## 7. API 設計（エンドポイント）

### ユーザー向け API

- `/api/user-app/users/register`（ユーザー登録）
- `/api/user-app/users/login`（ユーザーログイン）
- `/api/user-app/trainers`（トレーナー一覧取得）
- `/api/user-app/reservations`（予約作成）
- `/api/user-app/reservations/{id}`（予約キャンセル）
- `/api/user-app/reservations/history`（予約履歴）

### トレーナー向け API

- `/api/admin-app/trainers/login`（トレーナーログイン）
- `/api/admin-app/trainers`（トレーナー一覧取得）
- `/api/admin-app/trainers/schedule`（トレーナーのスケジュール管理）
- `/api/admin-app/trainers/reservations`（予約状況の確認）
- `/api/admin-app/trainers/reservations/{id}/cancel`（トレーナーによる予約キャンセル）
- `/api/admin-app/trainers/register`（新しいトレーナーの登録）
